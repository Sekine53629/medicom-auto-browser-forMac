# Word書式設定ガイド

## Pandocを使った高品質なWord文書の作成方法

### 手順1: Pandocのインストール

1. https://pandoc.org/installing.html にアクセス
2. 「Download the latest installer」をクリック
3. Windows用インストーラー（`.msi`）をダウンロード
4. インストーラーを実行してデフォルト設定でインストール

### 手順2: 基本的な変換（初回）

```batch
convert_to_word.bat
```

このバッチファイルをダブルクリックすると、以下の設定でWord文書が生成されます：

- **目次**: 自動生成（3階層まで）
- **章番号**: 自動付与
- **コードハイライト**: Tangoスタイル
- **メタデータ**: タイトル、著者、日付

### 手順3: カスタムスタイルの作成（推奨）

より見栄えの良い文書にするには、参照テンプレートを作成します。

#### 3-1. 参照テンプレートの作成

```batch
create_word_template.bat
```

このバッチファイルを実行すると `reference.docx` が作成されます。

#### 3-2. スタイルのカスタマイズ

`reference.docx` を開いて、以下のスタイルを編集します：

##### 見出しスタイル

| スタイル名 | 推奨設定 |
|-----------|---------|
| 見出し 1 | フォント: 游ゴシック Bold, サイズ: 18pt, 色: #2E5C8A |
| 見出し 2 | フォント: 游ゴシック Bold, サイズ: 16pt, 色: #2E5C8A |
| 見出し 3 | フォント: 游ゴシック Bold, サイズ: 14pt, 色: #4A4A4A |

**編集方法:**
1. 「ホーム」タブ → スタイルギャラリー
2. 「見出し 1」を右クリック → 「変更」
3. フォント、サイズ、色を変更
4. 「このテンプレートを使用した新規文書」を選択
5. 「OK」

##### 本文スタイル

| 項目 | 推奨設定 |
|-----|---------|
| フォント | 游ゴシック または Meiryo |
| サイズ | 11pt |
| 行間 | 1.5 |
| 段落前後 | 0.5行 |

##### コードブロックスタイル

| 項目 | 推奨設定 |
|-----|---------|
| フォント | Consolas または 源ノ角ゴシック Code |
| サイズ | 10pt |
| 背景色 | #F5F5F5 |
| 枠線 | 1pt, 灰色 |

**編集方法:**
1. 「ホーム」タブ → スタイルギャラリー → 「その他」ボタン
2. 「Source Code」を探して右クリック → 「変更」
3. 「書式」→「フォント」でConsolasを選択
4. 「書式」→「段落」→「インデント」で左右に0.5cmを設定
5. 「書式」→「罫線と網かけ」で背景色と枠線を設定

##### 表スタイル

| 項目 | 推奨設定 |
|-----|---------|
| ヘッダー背景 | #2E5C8A |
| ヘッダー文字色 | 白 |
| 枠線 | 1pt, 灰色 |
| 交互の行の背景 | #F9F9F9 |

**編集方法:**
1. 「デザイン」タブ → 「テーブルスタイル」
2. 好みのスタイルを選択または「新しいテーブルスタイル」で作成

#### 3-3. テンプレートの保存

1. すべてのスタイルを編集したら「上書き保存」
2. Wordを閉じる

### 手順4: カスタムスタイルで再変換

```batch
convert_to_word.bat
```

もう一度このバッチファイルを実行すると、カスタマイズしたスタイルが適用されたWord文書が生成されます。

---

## Pandocのオプション詳細

`convert_to_word.bat` では以下のオプションを使用しています：

### 基本オプション

- `--toc`: 目次を生成
- `--toc-depth=3`: 目次の深さを3階層まで
- `--number-sections`: 章番号を自動付与
- `--highlight-style=tango`: コードのシンタックスハイライト

### メタデータ

- `--metadata title="..."`: 文書のタイトル
- `--metadata author="..."`: 著者名
- `--metadata date="..."`: 日付

### スタイル

- `--reference-doc=reference.docx`: カスタムスタイルテンプレート

---

## 推奨フォント設定

### 日本語フォント

| 用途 | フォント | 理由 |
|-----|---------|------|
| 見出し | **游ゴシック Bold** | Windows標準、可読性が高い |
| 本文 | **游ゴシック** または **Meiryo** | 画面・印刷ともに読みやすい |
| コード | **Consolas** + **源ノ角ゴシック Code** | 等幅フォント、見分けやすい |

### 英数字フォント（コード用）

- **Consolas** (Windows標準)
- **Courier New**
- **Source Code Pro**（要インストール）
- **Fira Code**（要インストール）

---

## カラーパレット推奨

### プロフェッショナルなカラースキーム

| 用途 | カラーコード | 色名 |
|-----|------------|------|
| 見出し1,2 | #2E5C8A | ネイビーブルー |
| 見出し3 | #4A4A4A | ダークグレー |
| リンク | #0066CC | ブルー |
| コード背景 | #F5F5F5 | ライトグレー |
| 表ヘッダー | #2E5C8A | ネイビーブルー |
| 強調 | #E74C3C | レッド |
| 成功 | #27AE60 | グリーン |
| 警告 | #F39C12 | オレンジ |

---

## トラブルシューティング

### Q: 日本語が文字化けする

**A:** バッチファイルの先頭に `chcp 65001` を追加してUTF-8に設定しています。それでも文字化けする場合：

1. SETUP_GUIDE.md の文字コードがUTF-8であることを確認
2. メモ帳で開いて「名前を付けて保存」→エンコードを「UTF-8」に変更

### Q: コードブロックのフォントが変わらない

**A:** reference.docx の「Source Code」スタイルを編集してください：

1. reference.docx を開く
2. スタイルギャラリーで「Source Code」を探す
3. 右クリック → 「変更」→ フォントをConsolasに変更

### Q: 表のスタイルが適用されない

**A:** reference.docx で表スタイルを編集してください：

1. reference.docx に表を挿入
2. 「デザイン」タブでスタイルを設定
3. 上書き保存

### Q: 目次が表示されない

**A:** 目次フィールドを更新してください：

1. Word文書を開く
2. 目次を右クリック → 「フィールド更新」
3. 「目次をすべて更新する」を選択

---

## まとめ

1. **初回**: `convert_to_word.bat` で基本的な変換
2. **カスタマイズ**: `create_word_template.bat` で参照テンプレート作成 → スタイル編集
3. **再変換**: `convert_to_word.bat` でカスタムスタイル適用

この手順で、プロフェッショナルな見た目のWord文書を自動生成できます！
